<!doctype html>
<html lang="${lang}" dir="${dir}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <base href="${base_path}" />
    <title>${title}</title>
    <meta name="description" content="${description}" />
    <meta name="robots" content="${robots_meta}" />
    ${canonical_link}
    <link rel="icon" href="${favicon}" />
    ${apple_touch_icon} ${rss_link}

    <!-- Tailwind via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <!-- Lit via CDN -->
    <script type="module">
      import 'https://cdn.jsdelivr.net/npm/lit@3/+esm';
    </script>

    <!-- App components -->
    <script type="module" src="./components/layout/app-shell.js"></script>

    <!-- Dark mode: class-based strategy for Tailwind v4 browser build -->
    <style type="text/tailwindcss">
      @custom-variant dark (&:where(.dark, .dark *));
    </style>

    <!-- Theme custom properties -->
    <style>
      :root {
        --color-primary: ${primary};
        --color-accent: ${accent};
      }
    </style>

    <!-- Prose typography (browser build has no @plugin support) -->
    <link rel="stylesheet" href="./prose.css" />

    <!-- Preconnect hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
    <link rel="preconnect" href="https://cdn.simpleicons.org" crossorigin />

    <!-- Theme init â€” prevent FOUC -->
    <script>
      (function () {
        const stored = localStorage.getItem('theme');
        const prefersDark = matchMedia('(prefers-color-scheme: dark)').matches;
        const mode = '${theme_mode}';
        const dark =
          stored === 'dark' ||
          (stored !== 'light' &&
            (mode === 'dark' || (mode === 'system' && prefersDark)));
        if (dark) document.documentElement.classList.add('dark');
      })();
    </script>
  </head>
  <body class="bg-white dark:bg-gray-900">
    <a href="#main-content" class="sr-only focus:not-sr-only"
      >${a11y_skip_to_content}</a
    >
    <app-shell></app-shell>
  </body>
</html>
