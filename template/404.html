<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="${favicon}" />
    ${apple_touch_icon}
    <title>Redirecting...</title>
    <script>
      // SPA fallback: redirect to index.html with the original path
      // encoded as a query parameter for client-side routing.
      // basePath is replaced at build time with the configured base path.
      var basePath = '__BASE_PATH__';
      var fullPath = window.location.pathname;
      var query = window.location.search;
      var hash = window.location.hash;
      // Strip base path prefix so the SPA receives a relative route
      var relative = fullPath;
      if (
        basePath !== '/' &&
        relative.startsWith(basePath.replace(/\/$/, ''))
      ) {
        relative = relative.slice(basePath.replace(/\/$/, '').length) || '/';
      }
      window.location.replace(
        window.location.origin +
          basePath +
          '?p=' +
          encodeURIComponent(relative + query + hash),
      );
    </script>
  </head>
  <body>
    <p>Redirecting...</p>
  </body>
</html>
